### üìò Conceptos b√°sicos

- **Direcci√≥n IP (Internet Protocol)**: Es una direcci√≥n l√≥gica que identifica un dispositivo en una red. Puede cambiar con el tiempo (por ejemplo, si usas DHCP).
- **Direcci√≥n MAC (Media Access Control)**: Es una direcci√≥n f√≠sica √∫nica asignada a la tarjeta de red de un dispositivo. No cambia (salvo que se falsifique).

### üîó Relaci√≥n entre IP y MAC

En una red local (LAN), los dispositivos se comunican usando direcciones MAC, pero para enrutar datos entre redes (como en Internet), se usan direcciones IP. El **protocolo ARP (Address Resolution Protocol)** se encarga de traducir una IP a una MAC dentro de una red local.

### üõ†Ô∏è ¬øC√≥mo ver la relaci√≥n IP ‚Üî MAC?

#### En macOS:

1. Abre la Terminal.
2. Escribe:```Shell
    arp -a
    ```
    Esto mostrar√° una lista de IPs y sus direcciones MAC asociadas en la red local.

#### En Windows:

```Bat
arp -a
```

#### En redes m√°s grandes:

Se suele usar un **switch gestionable** o un **servidor DHCP** para ver qu√© IP tiene cada MAC.

---

13.1.1 Destino en la misma red

![[Pasted image 20250829092945.png]]

13.1.2 Destino en red remota

![[Pasted image 20250829093053.png]]

![[Pasted image 20250829094219.png]]

![[Pasted image 20250829094517.png]]


---
---

El protocolo **ICMP (Internet Control Message Protocol)** es fundamental en redes IP. Aqu√≠ te explico lo esencial:

---

### üß© ¬øQu√© es ICMP?

ICMP es un protocolo de red utilizado para enviar mensajes de control y error entre dispositivos. No transporta datos de usuario como TCP o UDP, sino que ayuda a diagnosticar y gestionar el estado de la red.

---

### üìå Usos comunes de ICMP

1. **Ping**
    
    - Verifica si un host est√° disponible.
    - Env√≠a un mensaje _Echo Request_ y espera un _Echo Reply_.
    - Ejemplo en terminal:```Shell
        ping 192.168.1.1
        ```
        
2. **Traceroute**
    
    - Muestra el camino que siguen los paquetes hasta un destino.
    - Usa mensajes ICMP _Time Exceeded_ para identificar cada salto.
    - En macOS:```Shell
        traceroute google.com
        ```
        
3. **Mensajes de error**
    
    - _Destination Unreachable_: cuando no se puede llegar a un destino.
    - _Time Exceeded_: cuando el TTL (Time To Live) de un paquete expira.

---

### üîê Consideraciones de seguridad

- ICMP puede ser usado en ataques (como _ping flood_ o _ICMP tunneling_).
- Por eso, muchos firewalls bloquean o limitan ICMP.

---

---

El t√©rmino **PDU (Protocol Data Unit)** es clave en redes y telecomunicaciones. Aqu√≠ te explico de forma clara qu√© significa y c√≥mo se relaciona con protocolos como ICMP:

---

### üì¶ ¬øQu√© es una PDU?

Una **PDU** es la unidad de datos que se transmite entre capas del modelo OSI (Open Systems Interconnection). Cada capa del modelo OSI tiene su propia PDU:

|**Capa OSI**|**Nombre de la PDU**|
|---|---|
|7. Aplicaci√≥n|Datos|
|6. Presentaci√≥n|Datos|
|5. Sesi√≥n|Datos|
|4. Transporte|Segmento|
|3. Red|Paquete|
|2. Enlace de datos|Trama (Frame)|
|1. F√≠sica|Bits|

---

### üß© PDU en el contexto de ICMP

ICMP opera en la **capa 3 (Red)** del modelo OSI. Por lo tanto, su PDU es un **paquete**. Este paquete contiene:

- Encabezado IP
- Encabezado ICMP
- Datos ICMP (como el identificador, secuencia, y payload en un ping)

---

### üõ†Ô∏è Ejemplo pr√°ctico: Ping

Cuando haces un `ping` a una IP:

1. Se genera una **PDU de capa 3** (paquete IP con datos ICMP).
2. Este paquete se encapsula en una **trama de capa 2** (con direcci√≥n MAC de origen y destino).
3. Se transmite como **bits** por la capa f√≠sica.

---

---
La **CEF Table** (Cisco Express Forwarding) es una parte fundamental del mecanismo de reenv√≠o de paquetes en dispositivos Cisco, especialmente en routers y switches multicapa. Aqu√≠ te explico c√≥mo funciona y qu√© contiene:

---

### üß† ¬øQu√© es Cisco Express Forwarding (CEF)?

CEF es una arquitectura de reenv√≠o de paquetes de capa 3 que permite a los dispositivos Cisco reenviar paquetes a **velocidad de l√≠nea** (wire speed), minimizando el uso del CPU y maximizando el rendimiento [[1]](https://community.cisco.com/t5/networking-knowledge-base/understanding-cisco-express-forwarding-cef-architecture/ta-p/5276856) [[3]](https://networklessons.com/switching/cef-cisco-express-forwarding)[[2]](https://www.cisco.com/c/en/us/support/docs/routers/12000-series-routers/47321-ciscoef.html).

---

### üì¶ Componentes principales de CEF

1. **FIB (Forwarding Information Base)**
    
    - Es una copia optimizada de la tabla de enrutamiento (RIB).
    - Contiene prefijos de destino IP y sus correspondientes **next-hop**.
    - Se actualiza autom√°ticamente cuando cambia la tabla de enrutamiento.
    - Permite b√∫squedas r√°pidas para determinar hacia d√≥nde enviar un paquete.
2. **Adjacency Table**
    
    - Derivada de la tabla ARP.
    - Contiene informaci√≥n de capa 2 (MAC, VLAN, interfaz) necesaria para encapsular el paquete.
    - Cada entrada en la FIB tiene una referencia a una entrada en la tabla de adyacencia.

---

### ‚öôÔ∏è Modos de operaci√≥n

- **CEF Centralizado**: Las tablas FIB y de adyacencia est√°n en el procesador de rutas (RP).
- **CEF Distribuido (dCEF)**: Las tarjetas de l√≠nea tienen copias locales de las tablas, lo que mejora la escalabilidad y el rendimiento [[1]](https://community.cisco.com/t5/networking-knowledge-base/understanding-cisco-express-forwarding-cef-architecture/ta-p/5276856) [[2]](https://www.cisco.com/c/en/us/support/docs/routers/12000-series-routers/47321-ciscoef.html).

---

### üîÑ Flujo b√°sico de paquetes con CEF

1. El paquete llega a la interfaz de entrada.
2. Se realiza una b√∫squeda en la FIB usando la IP de destino.
3. Se selecciona el next-hop y se accede a la tabla de adyacencia.
4. Se reescribe el encabezado de capa 2.
5. El paquete se coloca en la cola de salida para transmisi√≥n [[2]](https://www.cisco.com/c/en/us/support/docs/routers/12000-series-routers/47321-ciscoef.html).

---

### üß™ Verificaci√≥n y comandos √∫tiles

- Verificar si CEF est√° activo:```Shell
    show ip cef
    ```
    
- Activar CEF:```Shell
    conf t
    ip cef
    ```
    
- Ver tabla de adyacencia:```Shell
    show adjacency
    ```
    

---

  
References

[1] [Understanding Cisco Express Forwarding (CEF) Architecture](https://community.cisco.com/t5/networking-knowledge-base/understanding-cisco-express-forwarding-cef-architecture/ta-p/5276856)

[2] [Understand Express Forwarding - Cisco](https://www.cisco.com/c/en/us/support/docs/routers/12000-series-routers/47321-ciscoef.html)

[3] [CEF (Cisco Express Forwarding) - NetworkLessons.com](https://networklessons.com/switching/cef-cisco-express-forwarding)


---
---
El **protocolo ND (Neighbor Discovery)** es parte del conjunto de protocolos de **IPv6** y cumple funciones similares al protocolo **ARP** en IPv4, pero con muchas mejoras.

---

### üß© ¬øQu√© es ND?

**ND (Neighbor Discovery Protocol)** es un protocolo de la capa de red (capa 3 del modelo OSI) utilizado en redes IPv6 para:

- Descubrir otros dispositivos en la red local.
- Determinar sus direcciones MAC.
- Detectar routers disponibles.
- Detectar direcciones duplicadas.
- Configurar autom√°ticamente direcciones IP (stateless autoconfiguration).

---

### üì¶ Mensajes principales de ND

ND utiliza mensajes ICMPv6 para funcionar. Los m√°s importantes son:

|**Mensaje**|**Funci√≥n**|
|---|---|
|**Router Solicitation (RS)**|Un host solicita informaci√≥n a los routers.|
|**Router Advertisement (RA)**|Los routers anuncian su presencia y config info.|
|**Neighbor Solicitation (NS)**|Similar a ARP: se solicita la MAC de una IP.|
|**Neighbor Advertisement (NA)**|Respuesta con la MAC correspondiente.|
|**Redirect**|Indica una mejor ruta para alcanzar un destino.|

---

### üîê Seguridad

ND puede ser vulnerable a ataques como **spoofing** o **DoS**, por lo que se recomienda usar **SEND (Secure Neighbor Discovery)** en entornos cr√≠ticos.

---

### üõ†Ô∏è Ejemplo pr√°ctico

Cuando un dispositivo IPv6 quiere enviar datos a otro en la misma red:

1. Env√≠a un **Neighbor Solicitation** a la direcci√≥n solicitada.
2. El dispositivo destino responde con un **Neighbor Advertisement**.
3. Se establece la relaci√≥n IP ‚Üî MAC.

---

